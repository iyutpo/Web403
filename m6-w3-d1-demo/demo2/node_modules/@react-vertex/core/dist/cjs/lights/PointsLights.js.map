{"version":3,"sources":["../../../src/lights/PointsLights.ts"],"names":["PointLights","instances","diffuse","position","index","length","light","push","nextDiffuse","nextPosition","len","i","nextInstances"],"mappings":"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","sourcesContent":["type PointLightInstance = { index: number }\n\nexport default class PointLights {\n  instances: PointLightInstance[] = []\n\n  diffuse: number[] = []\n  position: number[] = []\n\n  add(diffuse = [0, 0, 0], position = [0, 0, 0]) {\n    const index = this.instances.length\n    const light = { index }\n\n    this.diffuse = [...this.diffuse, ...diffuse]\n    this.position = [...this.position, ...position]\n\n    this.instances.push(light)\n\n    return light\n  }\n\n  updateDiffuse({ index }: PointLightInstance, diffuse: number[]) {\n    const nextDiffuse = [...this.diffuse]\n    nextDiffuse[index * 3 + 0] = diffuse[0]\n    nextDiffuse[index * 3 + 1] = diffuse[1]\n    nextDiffuse[index * 3 + 2] = diffuse[2]\n\n    this.diffuse = nextDiffuse\n  }\n\n  updatePosition({ index }: PointLightInstance, position: number[]) {\n    const nextPosition = [...this.position]\n    nextPosition[index * 3 + 0] = position[0]\n    nextPosition[index * 3 + 1] = position[1]\n    nextPosition[index * 3 + 2] = position[2]\n\n    this.position = nextPosition\n  }\n\n  remove({ index }: PointLightInstance) {\n    const len = this.instances.length * 3\n\n    const diffuse = []\n    const position = []\n\n    for (let i = 0; i < len; i++) {\n      if (i < index * 3 && i > index * 3 + 2) {\n        diffuse.push(this.diffuse[i])\n        position.push(this.position[i])\n      }\n    }\n\n    const nextInstances = []\n\n    for (let i = 0; i < this.instances.length; i++) {\n      if (this.instances[i].index < index) {\n        nextInstances.push(this.instances[i])\n      } else if (this.instances[i].index > index) {\n        this.instances[i].index = this.instances[i].index - 1\n        nextInstances.push(this.instances[i])\n      }\n    }\n\n    this.diffuse = diffuse\n    this.position = position\n    this.instances = nextInstances\n  }\n}\n"],"file":"PointsLights.js"}