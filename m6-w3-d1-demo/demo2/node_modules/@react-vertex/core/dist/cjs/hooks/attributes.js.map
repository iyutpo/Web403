{"version":3,"sources":["../../../src/hooks/attributes.ts"],"names":["useAttribute","gl","size","buffer","getOptions","memoized","location","options","target","ARRAY_BUFFER","enableVertexAttribArray","bindBuffer","type","FLOAT","normalized","stride","offset","vertexAttribPointer","useInstancedAttribute","ext","WebGL2RenderingContext","vertexAttribDivisor","vertexAttribDivisorANGLE","console","log"],"mappings":";;;;;;;;AAAA;;AAIO,SAASA,YAAT,CACLC,EADK,EAELC,IAFK,EAGLC,MAHK,EAILC,UAJK,EAKL;AACA,MAAMC,QAAQ,GAAG,oBAAQ,YAAM;AAC7B,WAAO,UAASC,QAAT,EAA2B;AAChC,UAAIA,QAAQ,IAAI,CAAhB,EAAmB;AACjB,YAAMC,OAAO,GAAGH,UAAU,GAAGA,UAAU,CAACH,EAAD,CAAb,GAAoB,EAA9C;AACA,YAAMO,MAAM,GAAGD,OAAO,CAACC,MAAR,IAAkBP,EAAE,CAACQ,YAApC;AAEAR,QAAAA,EAAE,CAACS,uBAAH,CAA2BJ,QAA3B;AACAL,QAAAA,EAAE,CAACU,UAAH,CAAcH,MAAd,EAAsBL,MAAtB;AAEA,YAAMS,IAAI,GAAGL,OAAO,CAACK,IAAR,IAAgBX,EAAE,CAACY,KAAhC;AACA,YAAMC,UAAU,GAAGP,OAAO,CAACO,UAAR,IAAsB,KAAzC;AACA,YAAMC,MAAM,GAAGR,OAAO,CAACQ,MAAR,IAAkB,CAAjC;AACA,YAAMC,MAAM,GAAGT,OAAO,CAACS,MAAR,IAAkB,CAAjC;AAEAf,QAAAA,EAAE,CAACgB,mBAAH,CAAuBX,QAAvB,EAAiCJ,IAAjC,EAAuCU,IAAvC,EAA6CE,UAA7C,EAAyDC,MAAzD,EAAiEC,MAAjE;AACD;AACF,KAfD;AAgBD,GAjBgB,EAiBd,CAACf,EAAD,EAAKC,IAAL,EAAWC,MAAX,EAAmBC,UAAnB,CAjBc,CAAjB;AAmBA,SAAOC,QAAP;AACD;;AAEM,SAASa,qBAAT,CACLjB,EADK,EAELC,IAFK,EAGLC,MAHK,EAILC,UAJK,EAKL;AACA,MAAMC,QAAQ,GAAG,oBAAQ,YAAM;AAC7B,WAAO,UAASC,QAAT,EAA2Ba,GAA3B,EAAyD;AAC9D,UAAIb,QAAQ,IAAI,CAAhB,EAAmB;AACjB,YAAMC,OAAO,GAAGH,UAAU,GAAGA,UAAU,CAACH,EAAD,CAAb,GAAoB,EAA9C;AACA,YAAMO,MAAM,GAAGD,OAAO,CAACC,MAAR,IAAkBP,EAAE,CAACQ,YAApC;AAEAR,QAAAA,EAAE,CAACS,uBAAH,CAA2BJ,QAA3B;AACAL,QAAAA,EAAE,CAACU,UAAH,CAAcH,MAAd,EAAsBL,MAAtB;AAEA,YAAMS,IAAI,GAAGL,OAAO,CAACK,IAAR,IAAgBX,EAAE,CAACY,KAAhC;AACA,YAAMC,UAAU,GAAGP,OAAO,CAACO,UAAR,IAAsB,KAAzC;AACA,YAAMC,MAAM,GAAGR,OAAO,CAACQ,MAAR,IAAkB,CAAjC;AACA,YAAMC,MAAM,GAAGT,OAAO,CAACS,MAAR,IAAkB,CAAjC;AAEAf,QAAAA,EAAE,CAACgB,mBAAH,CAAuBX,QAAvB,EAAiCJ,IAAjC,EAAuCU,IAAvC,EAA6CE,UAA7C,EAAyDC,MAAzD,EAAiEC,MAAjE;;AAEA,YAAIf,EAAE,YAAYmB,sBAAlB,EAA0C;AACxCnB,UAAAA,EAAE,CAACoB,mBAAH,CAAuBf,QAAvB,EAAiC,CAAjC;AACD,SAFD,MAEO,IAAIa,GAAJ,EAAS;AACdA,UAAAA,GAAG,CAACG,wBAAJ,CAA6BhB,QAA7B,EAAuC,CAAvC;AACD,SAFM,MAEA;AACLiB,UAAAA,OAAO,CAACC,GAAR,CAAY,yDAAZ;AACD;AACF;AACF,KAvBD;AAwBD,GAzBgB,EAyBd,CAACvB,EAAD,EAAKC,IAAL,EAAWC,MAAX,EAAmBC,UAAnB,CAzBc,CAAjB;AA2BA,SAAOC,QAAP;AACD","sourcesContent":["import { useMemo } from 'react'\n\nimport { GLContext, GetAttributeOptions } from '../types'\n\nexport function useAttribute(\n  gl: GLContext,\n  size: number,\n  buffer: WebGLBuffer | null,\n  getOptions?: GetAttributeOptions,\n) {\n  const memoized = useMemo(() => {\n    return function(location: number) {\n      if (location >= 0) {\n        const options = getOptions ? getOptions(gl) : {}\n        const target = options.target || gl.ARRAY_BUFFER\n\n        gl.enableVertexAttribArray(location)\n        gl.bindBuffer(target, buffer)\n\n        const type = options.type || gl.FLOAT\n        const normalized = options.normalized || false\n        const stride = options.stride || 0\n        const offset = options.offset || 0\n\n        gl.vertexAttribPointer(location, size, type, normalized, stride, offset)\n      }\n    }\n  }, [gl, size, buffer, getOptions])\n\n  return memoized\n}\n\nexport function useInstancedAttribute(\n  gl: GLContext,\n  size: number,\n  buffer: WebGLBuffer,\n  getOptions?: GetAttributeOptions,\n) {\n  const memoized = useMemo(() => {\n    return function(location: number, ext?: ANGLE_instanced_arrays) {\n      if (location >= 0) {\n        const options = getOptions ? getOptions(gl) : {}\n        const target = options.target || gl.ARRAY_BUFFER\n\n        gl.enableVertexAttribArray(location)\n        gl.bindBuffer(target, buffer)\n\n        const type = options.type || gl.FLOAT\n        const normalized = options.normalized || false\n        const stride = options.stride || 0\n        const offset = options.offset || 0\n\n        gl.vertexAttribPointer(location, size, type, normalized, stride, offset)\n\n        if (gl instanceof WebGL2RenderingContext) {\n          gl.vertexAttribDivisor(location, 1)\n        } else if (ext) {\n          ext.vertexAttribDivisorANGLE(location, 1)\n        } else {\n          console.log('Instanced attributes require WebGL 2 or ANGLE extension')\n        }\n      }\n    }\n  }, [gl, size, buffer, getOptions])\n\n  return memoized\n}\n"],"file":"attributes.js"}